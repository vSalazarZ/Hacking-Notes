## Descripción 
In RSA d is a lot bigger than e, why don't we use d to encrypt instead of e? Connect with `nc jupiter.challenges.picoctf.org 19566`.

Hint:
1. What is e generally?
## Solución 1

Obtenemos un mensaje cifrado. Usamos las operaciones necesarias, que son la m, para desencriptar el mensaje original. Finalmente, convertimos el número a texto y obtuve la bandera.

```
Fromulas: RSA	- Llave pública - asimétrico

m	- mensaje en original o mensaje en texto plano
c	- mensaje cifrado (ciphertext)
p, q 	- son dos números primos distintos y muy grandes
n	- es el módulo (lo comparten las llaves públicas y privada)
tn	- totient n (función de euler)
e	- llave pública - 65537 (exponente) 2^16+1
d	- llave privada

Cálculos
-----------------------------
n  = p * q
tn = (p-1) * (q-1)
d  = e ^ -1 (mod tn)   -   pow(e, -1, tn)
-----------------------------
Cifrar (encriptar)

c = m ^ e (mod n)      -   pow(m, e, n)
-----------------------------
Descifrar (desencriptar)

m = c ^ d (mod n)      -   pow(c, d, n)

Usando python

omarsalazar@DESKTOP-H97NF1C:~$ python3
Python 3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c = 38748895403300168493079063485286521115259553611988901170794691495496206315783906539647009983024138241845101678732627432295942642120868405982244850737086398412861302320469439072553190482397685816781874280355190546359031004651878124575035482546853174297840745633974533576172194663460894881884824797043979767704
>>> n = 89200475112261915457520502669017799481791895610739601127086666607671245148529059245628723769302778940518514552184136826932114371866917961327815075078118782305987487558831022985822030390744773458122463448062180781525404257411055061526782898047006843411845449090979532014581837926851404483130782288886468954633
>>> e = 65537
>>> m = pow(c,e,n)
>>> m
180638594769037903267909311328535969949661653321164402927482237
>>> bytes.fromhex(hex(m)[2:]).decode()
'picoCTF{bad_1d3a5_2438125}'
>>>

flag: picoCTF{bad_1d3a5_2438125}
```

## Solución 2

Se usó una herramienta llamada RsaCtfTool con un ataque llamado ataque Wiener que permite encontrar la clave privada cuando ciertas condiciones se cumplen, y así obtener la bandera automáticamente.

```
omarsalazar@DESKTOP-H97NF1C:~$ source tools/bin/activate
(tools) omarsalazar@DESKTOP-H97NF1C:~$ RsaCtfTool --decrypt 27844646587193904535802535674488050516659480308726959329277955468460333651993327357302797392139858297281867229521094901846249131512578550880898932609919495621097763869773946800093660811777287676922124055300540913250022121339109527488074279777472783374108241730084456110957751130047454612555564197808603368845 -n 61856737083040249440986602516554750464744730654766583118656144559135662056911715635462026986641175434431503018906823960105049215501117807888178481805276036448056058733778660325322221711197896950918587193914720636284622523167773666369442382505751552166853119488192515513907287772933361937655735706905225760301 -e 5292136118903927226080105593944222131861752975895696042637060020188193801258891764469468930742894405616025106840571920355051512142984383612753356843953532320458448674969454691574224226196555110399153005696764433168221788374728148118784564052677884875898067676766858003876793264111874846124139205629562520065 --attack wiener
private argument is not set, the private key will not be displayed, even if recovered.
['/tmp/tmp4dqizerg']

[*] Testing key /tmp/tmp4dqizerg.
[*] Performing wiener attack on /tmp/tmp4dqizerg.
  4%|██▉                                                                            | 12/317 [00:00<00:00, 81311.22it/s]
[*] Attack success with wiener method !

Results for /tmp/tmp4dqizerg:

Decrypted data :
HEX : 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007069636f4354467b6261645f31643361355f323433383132357d
INT (big endian) : 180638594769037903267909311328535969949661653321164402927482237
INT (little endian) : 87923905202948747929485038101145329885662780869068806205906271807473816988775402377418682719649444868445877187610551753882344266036512845152388442597497763549412614116667294842294702404159096025700144848141669615740427973401517228342036689222651463969509806913768511268619595560075969805973031692663984750592
utf-8 : picoCTF{bad_1d3a5_2438125}
utf-16 : 楰潣呃筆慢彤搱愳張㐲㠳㈱紵
STR : b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00picoCTF{bad_1d3a5_2438125}'
(tools) omarsalazar@DESKTOP-H97NF1C:~$

flag: picoCTF{bad_1d3a5_2438125}
```

## Referencias 
1. https://factordb.com/